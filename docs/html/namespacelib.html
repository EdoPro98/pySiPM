<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PySiPM: lib Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PySiPM
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Python library to simulate Silicon PhotonMultipliers</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacelib.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">lib Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a629737e676aeb2b460569a22ac6574d0"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelib.html#a629737e676aeb2b460569a22ac6574d0">addDCR</a> (rate)</td></tr>
<tr class="memdesc:a629737e676aeb2b460569a22ac6574d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generation of dark count events.  <a href="namespacelib.html#a629737e676aeb2b460569a22ac6574d0">More...</a><br /></td></tr>
<tr class="separator:a629737e676aeb2b460569a22ac6574d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1e3459a02ac6f86b2ed0c424c7b025d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelib.html#ab1e3459a02ac6f86b2ed0c424c7b025d">HitCells</a> (n)</td></tr>
<tr class="memdesc:ab1e3459a02ac6f86b2ed0c424c7b025d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generation of cell IDs.  <a href="namespacelib.html#ab1e3459a02ac6f86b2ed0c424c7b025d">More...</a><br /></td></tr>
<tr class="separator:ab1e3459a02ac6f86b2ed0c424c7b025d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeef8a5575c78b94cbad58d261a3330e5"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelib.html#aeef8a5575c78b94cbad58d261a3330e5">addXT</a> (times, idx, xt)</td></tr>
<tr class="memdesc:aeef8a5575c78b94cbad58d261a3330e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generation of optical crosstalk events.  <a href="namespacelib.html#aeef8a5575c78b94cbad58d261a3330e5">More...</a><br /></td></tr>
<tr class="separator:aeef8a5575c78b94cbad58d261a3330e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a525d82714cff07b58269022959bf9756"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelib.html#a525d82714cff07b58269022959bf9756">addAP</a> (times, h, ap)</td></tr>
<tr class="memdesc:a525d82714cff07b58269022959bf9756"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generation of afterpulses.  <a href="namespacelib.html#a525d82714cff07b58269022959bf9756">More...</a><br /></td></tr>
<tr class="separator:a525d82714cff07b58269022959bf9756"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6376b4c935fad6bdd9255cdbc92e00b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelib.html#ae6376b4c935fad6bdd9255cdbc92e00b">SiPMEventAction</a> (times, idx)</td></tr>
<tr class="memdesc:ae6376b4c935fad6bdd9255cdbc92e00b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates relative signal height for each photoelectron.  <a href="namespacelib.html#ae6376b4c935fad6bdd9255cdbc92e00b">More...</a><br /></td></tr>
<tr class="separator:ae6376b4c935fad6bdd9255cdbc92e00b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb486e4454d4d7fdebaab37f3aed3cf8"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelib.html#afb486e4454d4d7fdebaab37f3aed3cf8">SiPMSignalAction</a> (times, sigH, snr=SNR, basespread=0)</td></tr>
<tr class="memdesc:afb486e4454d4d7fdebaab37f3aed3cf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generation of full SiPM signal.  <a href="namespacelib.html#afb486e4454d4d7fdebaab37f3aed3cf8">More...</a><br /></td></tr>
<tr class="separator:afb486e4454d4d7fdebaab37f3aed3cf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a4f56c3981c3695882fa421cc25bf0f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelib.html#a5a4f56c3981c3695882fa421cc25bf0f">PulseCPU</a> (t, h, gainvar)</td></tr>
<tr class="memdesc:a5a4f56c3981c3695882fa421cc25bf0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generation of single cell signals.  <a href="namespacelib.html#a5a4f56c3981c3695882fa421cc25bf0f">More...</a><br /></td></tr>
<tr class="separator:a5a4f56c3981c3695882fa421cc25bf0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0d2381286151e767b908961457f1f54"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelib.html#af0d2381286151e767b908961457f1f54">signalAnalysis</a> (signal, intstart, intgate, threshold)</td></tr>
<tr class="memdesc:af0d2381286151e767b908961457f1f54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Features extraction from signals.  <a href="namespacelib.html#af0d2381286151e767b908961457f1f54">More...</a><br /></td></tr>
<tr class="separator:af0d2381286151e767b908961457f1f54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b73eb3ac209e7c6d7f8754ff3131fb2"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelib.html#a8b73eb3ac209e7c6d7f8754ff3131fb2">somestats</a> (output, realpe=None)</td></tr>
<tr class="memdesc:a8b73eb3ac209e7c6d7f8754ff3131fb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function that displays histograms of generated events.  <a href="namespacelib.html#a8b73eb3ac209e7c6d7f8754ff3131fb2">More...</a><br /></td></tr>
<tr class="separator:a8b73eb3ac209e7c6d7f8754ff3131fb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b7fb9c244a8faf479618c130a01bd44"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelib.html#a5b7fb9c244a8faf479618c130a01bd44">sigPlot</a> (signal, npe, ndcr, dev)</td></tr>
<tr class="memdesc:a5b7fb9c244a8faf479618c130a01bd44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plot each signal pulse produced in the simulation.  <a href="namespacelib.html#a5b7fb9c244a8faf479618c130a01bd44">More...</a><br /></td></tr>
<tr class="separator:a5b7fb9c244a8faf479618c130a01bd44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a291fd9533c302e20ead86796bbda9841"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelib.html#a291fd9533c302e20ead86796bbda9841">initializeRandomPool</a> (seed=None)</td></tr>
<tr class="memdesc:a291fd9533c302e20ead86796bbda9841"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function that initializes random seeds for each worker in the multiprocessing Pool.  <a href="namespacelib.html#a291fd9533c302e20ead86796bbda9841">More...</a><br /></td></tr>
<tr class="separator:a291fd9533c302e20ead86796bbda9841"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1791d11a095959c5e306b5fc727d094"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelib.html#ac1791d11a095959c5e306b5fc727d094">SaveFile</a> (fname, out, other=None)</td></tr>
<tr class="separator:ac1791d11a095959c5e306b5fc727d094"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2fc0ac533597af557407d37902cdc49"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelib.html#af2fc0ac533597af557407d37902cdc49">SaveWaves</a> (fname, signals)</td></tr>
<tr class="separator:af2fc0ac533597af557407d37902cdc49"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a474dee6130f5d04c01b4cae4475ac8ab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelib.html#a474dee6130f5d04c01b4cae4475ac8ab">signalmodel</a> = <a class="el" href="_fortran_functions_8f90.html#a8cada1cd48629cb89ab1bdac3a6d6481">signalgenfortran</a>(0, 1, TFALL / SAMPLING, TRISE / SAMPLING, SIGPTS, 1)</td></tr>
<tr class="memdesc:a474dee6130f5d04c01b4cae4475ac8ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array containing the signal shape of the SiPM intended as the ideal signal generated by a signle photoelectron.  <a href="namespacelib.html#a474dee6130f5d04c01b4cae4475ac8ab">More...</a><br /></td></tr>
<tr class="separator:a474dee6130f5d04c01b4cae4475ac8ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">In this file I define all the functions I will use in the main file of simulation.</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a525d82714cff07b58269022959bf9756"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a525d82714cff07b58269022959bf9756">&#9670;&nbsp;</a></span>addAP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def lib.addAP </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generation of afterpulses. </p>
<p>Function that generates afterpulses(AP) events and adds them to the list of events to simulate. Each avalanche generates a poissonian number of AP events. APs are delayed from teyr main signal following a fast and slow exponential distributions. Theyr relative signal height is calculated consdering the cell recovery time as an RC circuit: </p><p class="formulaDsp">
\[h=1-e^{-\frac{\Delta_t}{\tau}}\]
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">times</td><td>List containing the time at which SiPM cells are fired, including DCR and XT events. </td></tr>
    <tr><td class="paramname">h</td><td>List containing the relative signal height of each fired cell. </td></tr>
    <tr><td class="paramname">ap</td><td>Value (probability) of AP events.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>times: List containing the time at which SiPM cells are fired, including AP events. </dd>
<dd>
h: List containing the relative signal height of each hitted cell. </dd></dl>

</div>
</div>
<a id="a629737e676aeb2b460569a22ac6574d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a629737e676aeb2b460569a22ac6574d0">&#9670;&nbsp;</a></span>addDCR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def lib.addDCR </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rate</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generation of dark count events. </p>
<p>Function that generates times for dark count events (DCR). Events are generated as an uniform poisson process, hence the time distance between consecutive DCR events follows an exponential distribution with a mean value of: \(\tau=\frac{1}{DCR}\)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rate</td><td>Dark counts rate un Hz.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>dcrTime: List containing times of DCR events in ns. </dd></dl>

</div>
</div>
<a id="aeef8a5575c78b94cbad58d261a3330e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeef8a5575c78b94cbad58d261a3330e5">&#9670;&nbsp;</a></span>addXT()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def lib.addXT </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generation of optical crosstalk events. </p>
<p>Function that generates optical crosstalk events(XT). Each photoelectron has generates a poissonian number of XT events accordingly to the crosstalk probability. XT events are generated in the 8 neighbouring cells and have the same time of the main cell.<br  />
 XT events can also generate other XT events in theyr neighbouring cells.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">times</td><td>List containing the time of each SiPM cell avalanche, including DCR events. </td></tr>
    <tr><td class="paramname">idx</td><td>List containing the ID of each fired cell. </td></tr>
    <tr><td class="paramname">xt</td><td>Value (probability) of XT events.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>times: List containing the time at which SiPM cells are fired including XT events </dd>
<dd>
idx: List containing the ID of the hitted cells including XT events. </dd></dl>

</div>
</div>
<a id="ab1e3459a02ac6f86b2ed0c424c7b025d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1e3459a02ac6f86b2ed0c424c7b025d">&#9670;&nbsp;</a></span>HitCells()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def lib.HitCells </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generation of cell IDs. </p>
<p>Function that generated cell IDs for each photoelectron in the list.<br  />
 Cell IDs are integers in range [0 - NCELLS] and are generated randomly. An ID can appear multiple times, meaning that the corresponding cell has generated an avalanche due to a photoelectron multiple times.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of photoelectrons that have to be simulated. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>idx: List containing the ID of each hitted cell. </dd></dl>

</div>
</div>
<a id="a291fd9533c302e20ead86796bbda9841"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a291fd9533c302e20ead86796bbda9841">&#9670;&nbsp;</a></span>initializeRandomPool()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def lib.initializeRandomPool </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function that initializes random seeds for each worker in the multiprocessing Pool. </p>
<p>This function extracts seeds using os.urandom, so from the operating system entropy pool, and uses the to set the seeds for the random generator and numpy random generator. Seeds need to be different for each worker, otherwise the random values are generate equally among workers. </p>

</div>
</div>
<a id="a5a4f56c3981c3695882fa421cc25bf0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a4f56c3981c3695882fa421cc25bf0f">&#9670;&nbsp;</a></span>PulseCPU()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def lib.PulseCPU </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gainvar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generation of single cell signals. </p>
<p>Function that generates the signal from a single SiPM cell. This is the "fast" version that uses a pre-computed signal shape and moves it in the "right" position in time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>Time at which the cell is triggered. </td></tr>
    <tr><td class="paramname">h</td><td>The relative pulse height of the cell signal </td></tr>
    <tr><td class="paramname">gainvar</td><td>Value of cell to cell gain variation for this signal.</td></tr>
  </table>
  </dd>
</dl>
<pre class="fragment">    @return s: Array containing the generated cell signal
</pre> 
</div>
</div>
<a id="ac1791d11a095959c5e306b5fc727d094"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1791d11a095959c5e306b5fc727d094">&#9670;&nbsp;</a></span>SaveFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def lib.SaveFile </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>other</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af2fc0ac533597af557407d37902cdc49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2fc0ac533597af557407d37902cdc49">&#9670;&nbsp;</a></span>SaveWaves()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def lib.SaveWaves </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>signals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af0d2381286151e767b908961457f1f54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0d2381286151e767b908961457f1f54">&#9670;&nbsp;</a></span>signalAnalysis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def lib.signalAnalysis </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>signal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>intstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>intgate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>threshold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Features extraction from signals. </p>
<p>Function that extracts some simple features from signals considering an integration gate. At the moment the features considered are:</p><ul>
<li>Peak: signal peak in the integration gate.</li>
<li>Integral: sum of samples in the integration gate corrected by the sampling time.</li>
<li>Time of Arrival: time position of the first sample above the threshold.</li>
<li>Time over Threshold: Number fo samples above the threshold corrected by the sampling time.</li>
<li>Time of Peak: time position of the sample in the peak. This list might be expanded in future with more complex features. <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">signal</td><td>Array containing the digitized signal. </td></tr>
    <tr><td class="paramname">intstart</td><td>Integer value containing the index corresponding to the start of the integration gate. </td></tr>
    <tr><td class="paramname">intgate</td><td>Integer value containing the lenght in units of samples of the integration gate. </td></tr>
    <tr><td class="paramname">threshold</td><td>Threshold used to calculate the values described above. It is automatically set to 1.5 times the single photoelectron peak height. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the features extracted. </dd></dl>
</li>
</ul>

</div>
</div>
<a id="a5b7fb9c244a8faf479618c130a01bd44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b7fb9c244a8faf479618c130a01bd44">&#9670;&nbsp;</a></span>sigPlot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def lib.sigPlot </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>signal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>npe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ndcr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Plot each signal pulse produced in the simulation. </p>
<p>Function used for debug purposes only. It creates a window for each worker and draws the signals as they are generated.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">signal</td><td>Array containing the generated SiPM signal. </td></tr>
    <tr><td class="paramname">npe</td><td>Total number of hitted cells. </td></tr>
    <tr><td class="paramname">ndcr</td><td>Total number of DCR events. </td></tr>
    <tr><td class="paramname">dev</td><td>String that describes the device on which the signal is computed. (cpu / cpu-fast / gpu) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae6376b4c935fad6bdd9255cdbc92e00b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6376b4c935fad6bdd9255cdbc92e00b">&#9670;&nbsp;</a></span>SiPMEventAction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def lib.SiPMEventAction </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates relative signal height for each photoelectron. </p>
<p>Since a SiPM cell may be hitted multiple times, recovery time has to be considered. If all cell IDs are different all signal heights are left unchanged with a value of 1, else if an ID appears multiple times then the first (in time) hit gives a signal height of 1 and the following will have a lower relative height. The relative signal height, after a \(\Delta_t\) time from the previous hit, is calculated supposing that each SiPM cell recovers as an RC circuit: </p><p class="formulaDsp">
\[h(\Delta_t)=1-e^{-\frac{t}{\tau}}\]
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">times</td><td>List containing the time of all events that have generated an avalanche in the SiPM cells. </td></tr>
    <tr><td class="paramname">idx</td><td>List containing the corresponding cell IDs of the events. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>h: List containing the relative signal height of each avalanche. </dd></dl>

</div>
</div>
<a id="afb486e4454d4d7fdebaab37f3aed3cf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb486e4454d4d7fdebaab37f3aed3cf8">&#9670;&nbsp;</a></span>SiPMSignalAction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def lib.SiPMSignalAction </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sigH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>snr</em> = <code>SNR</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>basespread</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generation of full SiPM signal. </p>
<p>Function that generates the full SiPM signal as the sum of the signals of each cell starting from gaussian noise.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">times</td><td>List containing the time at wich SiPM cells are fired, including DCR, XT and AP events </td></tr>
    <tr><td class="paramname">sigH</td><td>List containing the correspondin relative pulse height of each fired cell. </td></tr>
    <tr><td class="paramname">snr</td><td>Signal to noise ratio converted into the RMS of the gaussian noise. </td></tr>
    <tr><td class="paramname">basespread</td><td>Sigma of the value to add as baseline spread. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>signal: Array containing the complete sigitized SiPM signal. </dd></dl>

</div>
</div>
<a id="a8b73eb3ac209e7c6d7f8754ff3131fb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b73eb3ac209e7c6d7f8754ff3131fb2">&#9670;&nbsp;</a></span>somestats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def lib.somestats </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>realpe</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function that displays histograms of generated events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output</td><td>Array containing the signal features. </td></tr>
    <tr><td class="paramname">realpe</td><td>Optional parameter. Array containing the real number of photoelectrons given to the simulation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="namespacelib.html#af0d2381286151e767b908961457f1f54" title="Features extraction from signals.">signalAnalysis</a> for a description of the signal features. </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a474dee6130f5d04c01b4cae4475ac8ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a474dee6130f5d04c01b4cae4475ac8ab">&#9670;&nbsp;</a></span>signalmodel</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">lib.signalmodel = <a class="el" href="_fortran_functions_8f90.html#a8cada1cd48629cb89ab1bdac3a6d6481">signalgenfortran</a>(0, 1, TFALL / SAMPLING, TRISE / SAMPLING, SIGPTS, 1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Array containing the signal shape of the SiPM intended as the ideal signal generated by a signle photoelectron. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacelib.html">lib</a></li>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
